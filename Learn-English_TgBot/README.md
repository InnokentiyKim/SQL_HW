
[<img src="/images/LearnEngBot.jpg" width="200" height="200">]()


# Learn English - телеграм-бот для изучения английского языка по карточкам
> Бот помогает пользователю в изучении новых слов  
> Бот отправляет пользователю случайные карточки слов с вариантами ответов  
> Получив ответ от пользователя бот проверяет его на корректность и отправляет соответствующее сообщение  
> При необходимости бот дает подсказки пользователю в виде описания загаданного слова
#### Функционал бота позволяет:
> - проверить и улучшить свои знания английских слов и фраз
> - изучать слова как в прямом, так и в обратном переводе
> - получить статистику пользователя и по каждому изучаемому слову
> - получить подсказки от бота, используя dictionary API
> - изменить настройки бота: вкл/выкл. напоминания, изменить количество слов в раунде и режим перевода слов
#### Технологии и инструменты
> - База данных PostgreSQL
> - pyTelegramBot API

[<img src="/images/postgres.jpg" width="160" height="100">]()
[<img src="/images/telebot.jpg" width="90" height="90">]()

<hr>

- [Начало работы](#start)
  - [Чувствительная информация и окружение](#environment)
  - [Зависимости](#dependencies)
- [Работа бота](#bot)
  - [Запуск бота](#run_bot)
  - [Получение подсказок слов](#hints)
  - [Просмотр статистики](#statistics)
  - [Взаимодействие с базой данных](#database)
    - [Добавление новых слов](#add_words)
    - [Удаление слов](#delete_words)
  - [Изменение настроек бота](#settings)

<a name="start"></a>
## 1. Начало работы

* Перед запуском бота необходимо:
>- создать телеграмм бота (с помощью @BotFather) 
>- получить токен ТГ бота

_Все эти данные необходимы для работы бота и подготовке переменной окружения (.env). Читайте ниже._

<a name="environment"></a>
### 1.1. Чувствительная информация и окружение

* Вся чувствительная информация, необходимая для работы бота, должна храниться в переменной окружения (.env)  

_Список хранимых данных:_
   >- TOKEN - токен ТГ бота
   >- DB_NAME - имя базы данных  
   >- DIALECT - используемая база данных (postgresql)  
   >- USERNAME - имя пользователя для подключения к базе данных
   >- PASSWORD - пароль пользователя для подключения к базе данных
   >- PORT - номер порта (по умолчанию 5432)
   >- URL - url базы данных (по умолчанию localhost)

<a name="dependencies"></a>
### 1.2. Зависимости

* Перед запуском бота убедитесь, что у вас установлены все необходимые зависимости: `psycopg2-binary`, `python-dotenv`, `requests`, `SQLAlchemy` и `pyTelegramBotAPI`.
    
_Используйте файл `requirements.txt` в корне проекта_


<a name="bot"></a>
## 2. Работа бота

* Если вы проделали все предыдущие шаги, то бот готов к запуску.

_Алгоритм работы бота следующий:_
> 1. Введите команду `/start` в чат. После идентификации пользователя и приветствия
> бот предложит начать игру (тренировку) и ввести команду `/cards`. 
> Игра состоит из отдельных раундов, в каждом из которых предлагается N (карточек) слов для перевода.
> В карточках показываются только неизученные загаданные слова. Слова в карточках выбираются случайным образом.

> 2. После того как вы ввели команду `/cards`, бот начнет последовательно высылать карточки слов
> Ваша задача - отгадать правильный перевод слова из представленных вариантов.
> При этом испльзуются стандартные настройки игры:
>    - количество слов в раунде - 10
>    - режим перевода - с русского на английский
>    - индикатор изученности слова - 5 верных ответов подряд
>    
>   После выбора верного ответа бот предложит нажать кнопку `Далее`, чтобы перейти к следующему слову.
>   В случае выбора неверного ответа бот предложит попробовать еще раз. 

> 3. Бот сохраняет статистику пользователя и всех просмотренных слов в базе данных после окончания раунда.
> Пользователь может запросить текущую статистику в любой момент (для этого нажмите кнопку `Статистика`).
> В любой момент можно запросить подсказку нажав на кнопку `Подсказка`.
> Другие полезные команды:
>    - /help - помощь
>    - /info - информация о боте
>    - /add_word - добавить новое слово
>    - /delete_word - удалить слово

> 4. Бот позволяет пользователю изменять настройки поиска (нажав на кнопку `Настройки`), и поддерживает функции:  
> `изменить количество слов в раунде`, `изменить режим перевода`, `включить/выключить напоминания`, `сброс всех настроек`.


> 5. Команда `/add_word` добавляет новое слово в базу данных.
>    - Бот предложит ввести название нового слова на русском языке
>    - Далее предложит ввести перевод этого слова на английский
>    - После этого предложит ввести категорию слова
>    - В случае некорректного ввода каждого из пунктов бот предложит попробовать еще раз
>    - В случаем успеха новое слово добавляется в базу данных

> 6. Команда `/delete_word` удаляет слово из базы данных.
>    - Бот предложит ввести название слова на русском или английском языке
>    - В случаем корректного ввода и наличия слова в базе данных производится удаление
>    - В случаем успеха слово удаляется из базы данных


<a name="run_bot"></a>
### 2.1. Запуск бота

* Для запуска бота необходимо иметь только валидный токен ТГ бота.



<a name="hints"></a>
### 2.2. Получение подсказов слов

* Для получения подсказки нужно нажать на кнопку `Подсказка`.
* Подсказки можно брать неограниченное количество раз. 
* Подсказка представляет из себя описание слова на английском языке.
* При этом используется dictionary API.


<a name="statistics"></a>
### 2.3. Просмотр статистики

* Для просмотра статистики нужно нажать на кнопку `Статистика`.
* Статистика включает количество изучаемых слов, просмотренных слов, правильных ответов и рейтинг пользователя.
* Также показывается список всех категорий изучаемых слов.


<a name="database"></a>
### 2.4. Взаимодействие с базой данных

* При запуске бота выполняется идентификация и инициализация игровой сессии.
* При старте подгружается информация о пользоваетеле и выполняется выборка слов из базы данных.
* В случае неизвестного пользователя, в базе данных создается запись о новом пользователе и 
* сохраняется список стандартных слов.
* ER-диаграмма сущностей представлена на схеме ниже.  

[<img src="/images/EngCards_Schema.jpg">]()


<a name="add_words"></a>
#### 2.4.1. Добавление новых слов

    * Новые слова добавляются командой `/add_word`.
    * Новое слово вводится поэтапно: русское название, английское перевод, категория.
    * На каждом шаге при некорректном вводе бот предложит попробовать еще раз.


<a name="delete_words"></a>
#### 2.4.2. Удаление слов

    * Удаление слова выполняется командой `/delete_word`.
    * Для удаления слова достаточно ввести его русское или английское название.
    * При наличии слова в базе данных производится удаление.


<a name="settings"></a>
### 2.5. Изменение настроек бота

* При нажатии на кнопку "Настройки" пользователю станут доступны изменения настроек игры:
>    - изменение количества слов в раунде `изменить количество слов раунда` - вводится целое число в указанном диапазоне 
>    - включить/выключить напоминания `Вкл/Выкл напоминания`  
>    - выбрать удобный режим перевода слов `изменить режим перевода` - с русского на английский и обратно
>    - вернуться к базовым настройкам `сбросить все настройки`.



---
Автор:
[InnCent](https://github.com/InnokentiyKim/)
